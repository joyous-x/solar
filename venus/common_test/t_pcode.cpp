//
// Created by jiao on 2021/10/11.
//

#include "gtest/gtest.h"
#include "common/office/ms_xls.h"
#include "common/office/ms_vba.h"
#include "common/office/ms_vba_pcode.h"
#include "common/utils/utils.h"
#include "./helper.h"

typedef struct __st_stream_data {
    uint8_t*    data{ 0 };
    uint32_t    size{ 0 };
    uint8_t*    pcode{ 0 };
    uint32_t    pcode_size{ 0 };
    std::u16string name;
} stream_data_t;

extern int parse_as_ole(cfb_ctx_t* ctx, const char* filepath, olefile_t** out);

int get_vba_props(const olefile_t* ole, entry_tree_item_t* dir, vba_project_props_t& vba_props) {
    int nret = BQ::OK;
    do {
        uint8_t* buffer = 0;
        uint32_t size = 0;
        uint32_t dir_did = ((uint8_t*)dir - (uint8_t*)ole->entry_tree) / sizeof(entry_tree_item_t);

        ON_SCOPE_EXIT([&] { if (buffer) free(buffer); });
        nret = msvba::unpack_stream(ole, dir_did, &buffer, &size);
        if (nret != BQ::OK) {
            break;
        }

        nret = msvba().parse_dir_stream(buffer, size, &vba_props);
        if (nret != BQ::OK) {
            break;
        }

        for (uint32_t i = 0; i < vba_props.modules.size(); i++) {
            entry_tree_item_t* cur_node = nullptr;
            for (auto next_node = dir->parent->child_first; next_node; next_node = next_node->slibing_next) {
                if (0 == ucs::icmp(next_node->item->name, vba_props.modules[i].name.c_str())) {
                    cur_node = next_node;
                    break;
                }
            }
            if (cur_node == nullptr) {
                continue;
            }
            vba_props.modules[i].directory_id = ((uint8_t*)cur_node - (uint8_t*)ole->entry_tree) / sizeof(entry_tree_item_t);
        }
    } while (false);

    return nret;
}

int get_ole_identifiers(const olefile_t* olefile, entry_tree_item_t* vba_project, string_list_t& identifiers, uint16_t* vba_version) {
    if (olefile == nullptr || vba_project == nullptr) {
        return BQ::INVALID_ARG;
    }

    int nret = BQ::OK;
    bool little_endian = OleUtils::little_endian(&olefile->header);

    do {
        uint32_t did = vba_project - olefile->entry_tree;
        uint8_t* data = 0;
        uint32_t size = 0;

        ON_SCOPE_EXIT([&] { if (data) free(data); });
        nret = ole::read_stream(olefile, did, -1, &data, &size);
        if (nret != BQ::OK) {
            break;
        }

        if (vba_version && size > 4) {
            uint16_t version = *(const uint16_t*)(data + 2);
            version = XsUtils::byteorder2host(version, OleUtils::little_endian(&olefile->header));
            *vba_version = version;
        }

        nret = parse_performance_cache(data, size, &identifiers, little_endian);
        if (nret != BQ::OK) {
            break;
        }
    } while (false);

    if (nret != BQ::OK) {
        identifiers.release();
    }
    return nret;
}

int get_ole_identifiers(cfb_ctx_t* ctx, const olefile_t* olefile, string_list_t& identifiers, uint16_t* vba_version = 0) {
    if (olefile == nullptr) {
        return BQ::INVALID_ARG;
    }
    
    entry_tree_item_t* vba_project = nullptr;
    for (uint32_t i = 0; i < olefile->entry_count; i++) {
        entry_tree_item_t* cur_node = olefile->entry_tree + i;
        if (cur_node->item->obj_type != ole_dir_entry_stream) {
            continue;
        }

        if (0 != ucs::icmp(cur_node->item->name, u"_vba_project")) {
            continue;
        }

        vba_project = cur_node;
    }

    if (vba_project == nullptr) {
        return BQ::ERR_FORMAT;
    }
    return get_ole_identifiers(olefile, vba_project, identifiers, vba_version);
}

int get_ole_vbastreams(cfb_ctx_t* ctx, const olefile_t* olefile, vba_project_nodes_t* project, std::vector<stream_data_t>& vbas) {
    if (olefile == nullptr || project == nullptr || project->dir == nullptr) {
        return BQ::INVALID_ARG;
    }
    if (project->dir->parent == nullptr) {
        return BQ::INVALID_ARG;
    }

    int nret = BQ::OK;
    for (auto cur = project->dir->parent->child_first; cur; cur = cur->slibing_next) {
        if (0 == ucs::icmp(cur->item->name, u"dir")
            || 0 == ucs::icmp(cur->item->name, u"_vba_project")
            || 0 == ucs::nicmp(cur->item->name, u"__SRP_", 6)
            || 0 == ucs::nicmp(cur->item->name, u"frm", 3)) {
            continue;
        }
        stream_data_t stream_item;
        stream_item.name = cur->item->name;

        auto did = cur - olefile->entry_tree;
        nret = ole::read_stream(olefile, did, -1, &stream_item.data, &stream_item.size);
        if (nret != BQ::OK) {
            break;
        }
        vbas.push_back(stream_item);
    }
    return BQ::OK;
}

std::map<std::string, std::string> map_identifiers = {
    {"06158cac49622db9a3151d6e5d183ce1", "WordVBAWin16Win32Win64MacVBA6VBA7TemplateProjectstdoleOfficeMSFormsNormalThisDocument_EvaluatectlPopupCommandBarPopupcmbNewBarCommandBarDocument_OpenClsEventTdsAppActiveDocumentApplicationMdlTdsShowTipOnePageClsTdsShpDTShapeShpLBShpRQStdTypeInProcessOriFldNameg_rowNumg_columnNumg_SLFirstg_ZhuFirstg_ZMFirstg_SZFirstg_IndexTextg_MarkOrAllg_strTitleg_MC_Countg_SYGSg_DelIndexg_DelIndexTextg_FindCountStrTypestrLetterstrFirCharacterInsertMenucmbNewMenucmbNewBar_YScmbNewBar_CBcmbNewBar_YYCmdCommandBarButtonStartStatusGetSettingMsgBoxvbCriticalVersionCustomizationContextAttachedTemplateCommandBarsProtectionmsoBarNoProtectionControlsCaptionDeleteAddtemporarymsoControlPopupBeforeFaceIdStylemsoButtonIconAndCaptionCmdFmCmdMcCmdQyCmdYyCmdFlCmdCkCmdSyCmdBJSYXCmdSCSYBeginGroupStatemsoButtonUpCmdTwoPageCmdPrtPreviewCmdPRINTCmdPROTECTCmdUNPROTECTCmdFmCCmdMcCCmdQyCCmdYyCCmdFlCCmdCkCTooltipTextCmdSyCCmdBJSYXCCmdSCSYCCmdTwoPageCCmdPrtPreviewCCmdPRINTCCmdPROTECTCCmdZtitleCmdTTitle1CmdTTitle2CmdTTitle3CmdTTitle4CmdTTitle5CmdTTitle1FCmdTTitle2FCmdTTitle3FCmdTTitle4FCmdTTitle5FCmdDCmdLx1CmdLx2CmdLx3CmdLx4CmdLx41CmdLx5CmdLx6CmdZtitleCCmdTTitle1CCmdTTitle2CCmdTTitle3CCmdTTitle4CCmdTTitle5CCmdTTitle1FCCmdTTitle2FCCmdTTitle3FCCmdTTitle4FCCmdTTitle5FCCmdDCCmdLx1CCmdLx2CCmdLx3CCmdLx4CCmdLx41CCmdLx5CCmdSlCmdDSlCmdSSlCmdSLCONTCmdZWZCmdZWZZCmdZWZZFCmdZCmdZZCmdZZFCmdJZCmdTBJZSMCmdSTBJZSMCmdGTitleCmdTabTitleCmdSjTableCmdGSCmdGsGsCmdGXGsCmdSlCCmdDSlCCmdSSlCCmdZWZCCmdZWZZCCmdZWZZFCCmdZCCmdZZCCmdZZFCCmdJZCCmdTBJZSMCCmdSTBJZSMCCmdGTitleCCmdTabTitleCCmdSjTableCCmdGSCCmdGsGsCiMenuCountiNummsoBarNoCustomizePositionmsoBarTopVisibleActiveWindowActivePaneViewShowAllShowParagraphsFormFieldsCountProtectionTypewdNoProtectionSavedProgEntryShowStrblnBalloonfldRangelflrlwlhSelectionGetPointAssistantTopNewBalloonHeadingModemsoModeAutoDownShowShowHelp1ShowHelp2ShowHelp3ShowHelp4ShowHelp5ShowHelp6ShowHelp7ShowHelp8ShowHelp9ShowHelp10ShowHelp11ShowHelp12ShowHelp13ShowHelp14ShowHelp15ShowHelp16ShowHelp17ShowHelp18InsertFMshpFormFieldSeekViewwdSeekMainDocumentUnprotectwdGoToPagewdGoToFirstInsertBreakwdSectionBreakNextPageSectionsHeaderswdHeaderFooterPrimaryLinkToPreviousPageSetupTopMarginMillimetersToPointsRightMarginFooterDistanceHeaderDistanceStylesFootersTypeTextParagraphFormatAlignmentwdAlignParagraphLeftInsertSymbolCharacterNumberUnicodeBiaswdFieldFormTextInputEntryMacroExitMacroEnabledOwnHelpHelpTextOwnStatusTextInputEditTypewdRegularTextDefaultEndKeyTypeParagraphTablesNumRowsNumColumnsDefaultTableBehaviorwdWord9TableBehaviorAutoFitBehaviorwdAutoFitFixedApplyStyleHeadingRowsApplyStyleLastRowApplyStyleFirstColumnApplyStyleLastColumnBorderswdBorderTopLineStylewdLineStyleNonewdBorderLeftwdBorderBottomwdBorderRightwdBorderDiagonalDownwdBorderDiagonalUpHomeKeyUnitwdLineExtendwdExtendMoveUpMoveDownMoveLeftMoveRightwdCharacterFontNameFarEastNameAsciiNameOtherGBTagHBTagDBTagQBTagwdFieldFormDropDownDropDownListEntriesClearShapesAddLineLockAnchorRelativeVerticalPositionwdRelativeVerticalPositionPageZOrdermsoBringToFrontCentimetersToPointsgpathInlineShapesAddPictureFileNameLinkToFileSaveWithDocumentAddShapemsoShapeRectanglemsoFalsemsoSendBehindTextwhatwdGoToBookmarkSplitSpecialwdPaneNonePaneswdNormalViewwdOutlineViewwdPrintViewwdSeekCurrentPageHeaderHeaderFooterIsHeaderwdSeekCurrentPageFooterFieldswdFieldPagePageNumbersNumberStylewdPageNumberStyleArabicHeadingLevelForChapterIncludeChapterNumberChapterPageSeparatorwdSeparatorHyphenRestartNumberingAtSectionStartingNumberiProtectedForFormsProtectPasswordNoResetwdAllowOnlyFormFieldswdGoToLinewdGoToLastInsertFooterIniDocumentwdSentenceBookmarksDefaultSortingwdSortByLocationShowHiddenDifferentFirstPageHeaderFooterOddAndEvenPagesHeaderFooterFootnotesLocationwdBottomOfPageNumberingRulewdRestartContinuouswdNoteNumberStyleArabicChgNamerngResultTypeBackspaceExistsflagePrtfindParParagraphfindRaniParaCountParagraphsstrContentHStrTrimGetFMTypeProcessTwoPageHeaderjInformationwdActiveEndPageNumberwdGoToSectionwdGoToAbsolutewdHeaderFooterEvenPagesLeftMarginMirrorMarginsProcessOnePageHeaderInsertFigTblNoteerrorhandleInsertFigTblMulNoteInsertFigTblFirNoteListGallerieswdOutlineNumberGalleryListTemplatesListLevelsNumberFormatTrailingCharacterwdTrailingNonewdListNumberStyleArabicNumberPositionwdListLevelAlignLeftTextPositionTabPositionwdUndefinedResetOnHigherStartAtBoldItalicStrikeThroughSubscriptSuperscriptShadowOutlineEmbossEngraveAllCapsHiddenUnderlineColorSizeAnimationDoubleStrikeThroughLinkedStylewdTrailingTabwdListNumberStyleLowercaseLetterwdListNumberStyleLowercaseRomanwdListLevelAlignRightListFormatApplyListTemplateListTemplateContinuePreviousListApplyTowdListApplyToWholeListDefaultListBehaviorwdWord10ListBehaviorInsertTextNoteInsertTextMulNoteInsertTextFirNoteInsertTJInsertPJInsertFirstTTitleInsertSecondTTitleInsertThirdTTitleInsertForthTTitleInsertFifthTTitleInsertZTitleInsertExampleInsertMulExampleInsertFirExampleInsertExampleContentInsertParagraphInsertTWJzInsertTBJzInsertFigTblFooteriCountwdWithInTablewdParagraphInsertFigTblFirFooterInsertFlZTitleInsertFlPTitleInsertFlBTitleInsertFlTTitle1InsertFlTTitle2InsertFlTTitle3InsertFlTTitle4InsertFlTTitle5InsertFlBsInsertReferencesMoveBKDesignIndexTCSResShowHiddenTextFindClearFormattingReplacementForwardWrapwdFindStopMatchCaseMatchWholeWordMatchByteMatchWildcardsMatchSoundsLikeMatchAllWordFormsExecutevbYesNovbQuestionvbNoProcessIndexFormatInsertIndexPagewdStoryInsertLx1InsertLx2InsertLx3InsertLx4int_Titleint_ZmBhInsertLx41InsertLx5InsertLx6InsertSy1InsertSy2InsertSy3InsertSy4InsertSy5InsertSy6InsertSy7InsertSy8InsertSy9InsertGTInsertTabProcessPrintItemShadedmsoBringInFrontOfTextHaveBAHProcessEditFieldNullSourceStrAscpicInlineShapeHeightProcessFontPagewdPageNumberStyleUppercaseRomanInsertTableFrmTableTbleTableCharacterswdLineStyleSingleLineWidthwdLineWidth100ptwdColorAutomaticwdBorderHorizontalwdLineWidth050ptwdBorderVerticalRowsCellsMergeEndOfwdTableInsertEquationLeftIndentCharacterUnitFirstLineIndentFirstLineIndentAddOLEObjectClassTypeDisplayAsIconwdAlignParagraphCenterInsertEquationNumFindTextInsertFLEquationNumvbTabCaptionLabelsInsertCaptionLabelTitleAutoTextTitlewdCaptionPositionBelowExcludeLabeli_Firsti_SecondwdFieldEmptyPreserveFormattingUpdateiNumFiNumSxhgxwdFirstCharacterLineNumberwdGoToEquationWhichwdGoToNextUpdateFieldTCSUpdateEquationNumTCStempRangefrmUpDateLabel3Label4fieldsCountValPrintPreviewTCSPrintPreviewInsertCharacterGetSecNumstrtempSelRaniCountParastrLengthstrIndexChrvbTextCompareInsertFirTitleInsertSecTitleInsertThiTitleInsertForTitleInsertFifTitleInsertFigTitleInsertTblTitleShowfrmMarkIndexfrmMarkIndexDelBeoforeMarkAllfindFlagMarkIndexItemsstrTitle1strTitle2GetIndexTitleSignleIndexesMarkEntryEntryEntryAutoTextCrossReferenceCrossReferenceAutoTextBookmarkNameReadinglblWidlblJDstrZWstrFLstrTempDuinCrementWidinCrementCapstrTitleArryGetIndexTitleAllGetIndexTitleBasedonUnTitleinWidinCaptempWidtempCaptbSumflTbSumiTableCountkcelTableCellcelRangeStartmyRangeListParasListParagraphsmyStringSetRangeListStringstr_Findstr_FindInstr_FindTextint_Countstr_FindDotttInsertTCSIndexWordBasicFormatFieldFieldLockedReplacewdReplaceAllstrNumlengthstrTempstrZWZTitlestrFLZTitlestrTablestrGraphstrNewstrNewLengthflagstrFstrSIsNumericReSortIndexByAscendUnlinkDocumentsActivateTextToTableConvertFromInitialColWidthwdAutoPositionApplyAutoFitSetDefaultWord8iTbleIndexiRowCountsyTypestrItemsorowRowSortExcludeHeaderFieldNumberSortFieldTypewdSortFieldSyllableSortOrderwdSortOrderAscendingFieldNumber2SortFieldType2SortOrder2FieldNumber3SortFieldType3SortOrder3SeparatorwdSortSeparateByCommasSortColumnCaseSensitiveLanguageIDwdSimplifiedChineseSubFieldNumberSubFieldNumber2SubFieldNumber3strRange1strRange2strRange3InsertRowsAboveConvertToTextwdSeparateByParagraphsNestedTablesRemoveSmartTagsShowfrmDelIndexfrmDeleteIndexDelIndexItemsPrctTCSUnPrctTCSDeleteDuplicateMenucbIndexcbStringwdActiveEndSectionNumberCmdGZCmdGZCCmdLx51CmdLx51CCmdLx6CCmdGXGsCCmdCk_ClickCtrlCancelDefaultCmdCkC_ClickRightCmdD_ClickCmdDC_ClickCmdDSl_ClickCmdDSlC_ClickCmdBJSYX_ClickCmdBJSYXC_ClickCmdGXGs_ClickCmdGXGsC_ClickCmdPRINT_ClickCmdPRINTC_ClickDialogswdDialogFilePrintCmdPROTECT_ClickCmdPROTECTC_ClickCmdUNPROTECT_ClickCmdPrtPreview_ClickCmdPrtPreviewC_ClickCmdSCSY_ClickCmdSCSYC_ClickCmdSSl_ClickCmdSSlC_ClickCmdSLCONT_ClickCmdGS_ClickCmdGSC_ClickCmdGsGs_ClickCmdGsGsC_ClickCmdFl_ClickCmdFlC_ClickFrmFLCmdFm_ClickCmdFmC_ClickFrmChoiceCmdGTitle_ClickCmdGTitleC_ClickCmdGZ_ClickCmdGZC_ClickShellvbMaximizedFocusCmdJZ_ClickCmdJZC_ClickProtectedTxtFootTxtChgiSidewdWebViewwdPrintPreviewwdSeekFootnoteswdPaneFootnotesMoveEndfrmJzPtwdStyleFootnoteReferenceftCmdLx1_ClickCmdLx1C_ClickCmdLx2_ClickCmdLx2C_ClickCmdLx3_ClickCmdLx3C_ClickCmdLx4_ClickCmdLx4C_ClickCmdLx41_ClickCmdLx41C_ClickCmdLx5_ClickCmdLx5C_ClickCmdLx51_ClickCmdLx51C_ClickCmdLx6_ClickCmdLx6C_ClickCmdMc_ClickCmdMcC_ClickFrmContentCmdQy_ClickCmdQyC_ClickCmdSjTable_ClickCmdSjTableC_ClickCmdTBJZSM_ClickCmdTBJZSMC_ClickCmdSTBJZSM_ClickCmdSTBJZSMC_ClickCmdYy_ClickCmdYyC_ClickCmdSl_ClickCmdSlC_ClickCmdSy_ClickCmdSyC_ClickCmdTabTitle_ClickCmdTabTitleC_ClickCmdTTitle1_ClickCmdTTitle1C_ClickCmdTTitle2_ClickCmdTTitle2C_ClickCmdTTitle3_ClickCmdTTitle3C_ClickCmdTTitle4_ClickCmdTTitle4C_ClickCmdTTitle5_ClickCmdTTitle5C_ClickCmdTTitle1F_ClickChgToSongCmdTTitle1FC_ClickCmdTTitle2F_ClickCmdTTitle2FC_ClickCmdTTitle3F_ClickCmdTTitle3FC_ClickCmdTTitle4F_ClickCmdTTitle4FC_ClickCmdTTitle5F_ClickCmdTTitle5FC_ClickLineUnitBeforeLineUnitAfterLineSpacingRulewdLineSpaceSingleCmdZ_ClickCmdZC_ClickCmdZtitle_ClickCmdZtitleC_ClickCmdZWZ_ClickCmdZWZC_ClickCmdZWZZ_ClickCmdZWZZC_ClickCmdZWZZF_ClickCmdZWZZFC_ClickCmdZZ_ClickCmdZZC_ClickCmdShowHelp_ClickWInimsoButtonDownCmdTwopage_ClickCmdTwoPageC_ClickCmdZZF_ClickCmdZZFC_ClickTdsApp_DocumentBeforeCloseDocDocumentCancelPathTdsApp_WindowSelectionChangeSelLostFocusSetFldNullNewNamemystartChrWiLenStdStrScrollIntoViewFrmAddFootcmdCancel_ClickcmdOk_ClicktxtJzvbOKOnlyvbInformationtxtJz_KeyDownKeyCodeReturnIntegerShiftCancel_ClickOptButton1ValueOptButton2OptButton3OptButton4UserForm_ActivateaProcessParentIndxLstContentSelectedADstrGStrupDateCountRegStrListCountListSaveSettingMCFldRightIndentHyphenationOutlineLevelwdOutlineLevelBodyTextCharacterUnitLeftIndentCharacterUnitRightIndentNoSpaceBetweenParagraphsOfSameStyleTabStopsClearAllwdAlignTabRightLeaderwdTabLeaderDotsSpacingwdReplaceOneLstContent_ChangeTxtSelAddItemfrmDateGetDChwnduser32ReleaseDChdcGetDeviceCapsnIndexgdi32LOGPIXELSXFindWindowlpClassNamelpWindowNameGetWindowLongSetWindowLongdwNewLongGWL_STYLEWS_BORDERWS_CAPTIONCreateRectRgnX1Y1X2Y2CombineRgnhDestRgnhSrcRgn1hSrcRgn2nCombineModeDeleteObjecthObjectSetWindowRgnhRgnbRedrawRGN_ORPointToPixelGetSystemMetricsSM_CXSCREENDTPicker1_CloseUpDTPicker1UserForm_InitializeltwhlPIXELSXxStartUpPositionlStylevbNullStringctlhRgnAllhRgnCtlhrngallcmdFindNext_ClicktxtIndexResponsevbYescmdDeletecmdDelete_ClickcmdDeleteAll_ClicktxtIndex_ChangecmdFindNextcmdDeleteAllFrmEditFootOriFootIniLstAddFootlstJZListIndexlstJZ_ClickOptGFtxtTitletxtTitle_ChangeCmdOKtxtTitle_KeyDownSetFocusfrmFLBSFrmFootTypeOptAddcmdMarkcmdMark_ClickcmdMarkAll_ClickBackColorLabel6_ClickcmdMarkAlltxtRowtxtColumntxtColumn_KeyDowntxtRow_KeyPressKeyAsciitxtColumn_KeyPressUserForm_QueryCloseCloseModeClassClickDocumentBeforeCloseWindowSelectionChange_B_var_Right_B_var_Trim_B_var_ChrW_B_var_Left_B_var_Mid"},
    {"0738368f06ac6a69f724ab5d9024b2b2", "ExcelVBAWin16Win32MacVBA6MCSJstdoleMSFormsEasyINIMSComctlLibOfficeRichTextLibDAOMSComDlgRunProThisWorkbook_EvaluateSheet1输入门窗表syFstrAcSheetActiveSheetFextliWorkbooksCountItemMsgBoxvbExclamationKzmActivateSheetsrcr1Cellsstr2ValueFontColorIndexwWjAcFileActiveWorkbookUserForm1OptionButton3str1str3fextLCaseTrimSelectionstr4格式铝材SYSTEM_INFOdwOemIDdwPageSizelpMinimumApplicationAddresslpMaximumApplicationAddressdwActiveProcessorMaskdwNumberOrfProcessorsdwProcessorTypedwAllocationGranularitydwReservedMEMORYSTATUSdwLengthdwMemoryLoaddwTotalPhysdwAvailPhysdwTotalPageFiledwAvailPageFiledwTotalVirtualdwAvailVirtualSM_CXSCREENSM_CYSCREENGetDriveTypenDrivekernel32GetDiskFreeSpacelpRootPathNamelpSectorsPerClusterlpBytesPerSectorlpNumberOfFreeClusterslpTtoalNumberOfClustersGlobalMemoryStatuslpBufferGetSystemInfolpSystemInfoGetSystemMetricsnIndexuser32WNetGetConnectionlpszLocalNamelpszRemoteNamecbRemoteNamempr.dllsinfominfobggsymchiRangeRowHeightSizeBoldInteriorxlNoneColumnsColumnWidthHorizontalAlignmentxlCenterOrientationAddIndentShrinkToFitPageSetupxlLandscapeValIDShellvbNormalFocusretncvbOKCancelRightFooterLeftMarginRightMarginBottomMarginTopMarginFooterMarginSavexlLeftlcvbCrLfvbYesNoCancelKillnewfileInputBoxAddSaveAsFileNameFileFormatxlNormalPassWordWriteResPasswordReadOnlyRecommendedCreateBackupActiveCellFormulaR1C1R2gcmApplicationCutCopyModeCopyPasteSpecialPastexlValuesOperationSkipBlanksTransposevbInformationActiveWindowSortKey1Order1xlAscendingKey2Order2Key3Order3HeaderxlGuessOrderCustomMatchCasexlTopToBottomSortMethodxlPinYinR4RBRIRzRz2R3c3colorlYhpxszUserForm3ShowMyRangerange1title1title2titleCurrentRegionPivotCachesSourceTypexlDatabaseSourceDataAddressCreatePivotTableTableDestinationTableNamePivotTablesSmallGridAddFieldsRowFieldsPivotFieldsxlDataFieldstr_namePivotFieldCaptionxlSumR5str5val1nTextBox20InsertShiftxlToRightCutCharactersStartLengthFontStyleStrikethroughSuperscriptSubscriptOutlineFontShadowUnderlinexlUnderlineStyleNonexlAutomaticNumberFormatLocalAutoFillDestinationxlFillDefaultBordersxlDiagonalDownLineStylexlDiagonalUpxlEdgeLeftxlContinuousWeightxlThinxlEdgeTopxlEdgeBottomxlEdgeRightxlInsideVerticalxlInsideHorizontalScreenUpdatingCheckBox6lswounformYRYlrYHLOOPYRZyouhuaWindowsylrhstrDeletexlToLeftxlFillSeriesRowsxlDownMergeAutoFitCenterHorizontallyWorksheetsxlbFindWindowlpClassNamelpWindowNamePostMessagehwndwMsgwParamlParamWM_CLOSECommandButton3_ClickHideCheckBox1_ClickStatusBar1PanelsCheckBox2_ClickCheckBox3_ClickCheckBox4_ClickCheckBox5_ClickCheckBox6_ClickCheckBox7_ClickCommandButton1_ClickvbDirectoryMkDirOptionButton1fnRightCheckBox7CheckBox1CheckBox2BlCheckBox3pjCheckBox4McbCheckBox40DC_lksCheckBox5chblCheckBox8chlcCommandButton2_ClickCommandButton4_ClickColumnvbOKOnlyForm2OptionButton1_ClickOptionButton2_ClickOptionButton3_ClickUserForm_ActivateAutoSizesbrSpringMinWidthsbrNoAutoSizeStylesbrTimeBevelsbrRaisedreC5INIinifilenameGetFromINICheckBox41CheckBox42CheckBox39CheckBox38CheckBox32CheckBox33CheckBox34TextBox22OptionButton9OptionButton10TextBox23TextBox24TextBox25主程序QIDOAuto_OpenAddMumenuCommandBarControlTBVarCounterToolbarArraybHaveCustomerToolBarCommandBarsControlsmsoControlPopupmsoControlButtonOnActionFaceIdBeginGroupEnabledToolbarsAddToolsauto_closeResetZcUserForm4gcmdForm4lcmdaboutUserForm2myToolBarPositionmsoBarFloatingMenuBarTemporaryVisibleBefore玻璃配件blNColumnFieldsc4str3_1MsgvbQuestionvbYesNovbYesBL_tzBLmc_hyRowRO_blBLgcmci_1vbNo100LR_blcpBL_qgtjR1_2myrange_2PJNxlFormatsfmcSWShSht1fexistS1S2MclhGcmcMcxlMcdhMc_wMc_hmcSlMcs_fxMcs_wMcs_hRoLs_wLs_wslLs_hLs_hslLs_jlLS_wjsLS_hjsmLs_jl1Ls_jl2OffsetWorksheetFunctionCountBlanki1RaFormulaLR_lkls页面插入宏1fhmb插入字符strLNL图号尺寸输入2th运行提示tmcTHC优化铝材xcdhliaoHfpathRunRunExemydsheetysuaselhselxselyClearContentsRow_1Column_1c1CheckBox28ChDriveRunProczlsyhlId4WaitNowTimeValueCheckBox27vbHidetry2SendKeysreyhlcxhlccdEOFFileCopy排序selcxzzlPxsheetfindwk2qsLspxbjbJmdR0findstrfiedfllFindWhatAfterLookInxlFormulasLookAtxlPartSearchOrderxlByRowsSearchDirectionxlNextfirowloop1FindNexttestproteretfileFindFileDisplayAlertsChangeFileAccessxlReadOnlyFullNameQuitsrcPathDirReturnsubdirsfilefoundpathUCaseATTR_DIRECTORYGetAttr优化玻璃BLYHmyrange2myrange4BLzlblhdblysliaoWliaoLsheet_L4zjsIsNumericTemprebl打印filedbfxzynPrintAreaSelectedSheetsPrintOutFromCopiesCollate追踪数量trackShowDependents下料表ErrDescriptionXLRLeftHeaderHeaderMarginblwcolorfind_xcCoxc_wblwhFnblbooknhzyhBlFxzdyhkclczddyxldjxljfyhzlcCheckBox25_ClickAddToINICheckBox25CheckBox27_ClickCheckBox28_ClickCheckBox32_ClickCheckBox33_ClickCheckBox34_ClickCheckBox38_ClickCheckBox39_ClickCheckBox40_ClickCheckBox41_ClickCheckBox42_ClickCommandButton12_ClickCommandButton13_ClickCommandButton14_ClickMultiPage1CheckBox26wlSmallScrollDownLmqxmXC1Page1TextBox1XC2TextBox4XC3TextBox7XC4TextBox10TextBox2xc1_wTextBox3xc1_hTextBox5xc2_wTextBox6xc2_hTextBox8xc3_wTextBox9xc3_hTextBox11xc4_wTextBox12xc4_herrblherrblwerrlcslerrblslerrdyslerrwlyxcfindlcPatternxlSolidsavenblsnlcsnlyxcerrpjslLxs1L11Lxs2L21Lxs3L31Lxs4L41Lxs5L51Lxs6L61LXC1L12LXC2L22LXC3L32LXC4L42LXC5L52LXC6L62LTJ1L13LTJ2L23LTJ3L33LTJ4L43LTJ5L53LTJ6L63Ltz1L14Ltz2L24Ltz3L34Ltz4L44Ltz5L54Ltz6L64Rxs1R11Rxs2R21Rxs3R31Rxs4R41Rxs5R51Rxs6R61RXC1R12RXC2R22RXC3R32RXC4R42RXC5R52RXC6R62RTJ1R13RTJ2R23RTJ3R33RTJ4R43RTJ5R53RTJ6R63Rtz1R14Rtz2R24Rtz3R34Rtz4R44Rtz5R54Rtz6R64errlccherrlccsSavetsLsum1Lsum2Lsum3Lsum4Lsum5Lsum6Rsum1Rsum2Rsum3Rsum4Rsum5Rsum6LZSUMRZSUMXcmcXccdXcsLWC1yxwcTZ1TZBSerrzstr6errbzgserrCheckBox18CheckBox15CheckBox16CheckBox19CheckBox20CheckBox17CheckBox21CheckBox23CheckBox22LCRLBRBLRwucAccompCommandButton15_ClickCommandButton5_ClickErrHandlerCommonDialog1InitDirFilterFilterIndexShowOpensafileCommandButton6_ClickShowSaveCommandButton7_ClickCommandButton8_ClickCommandButton9_ClickOptionButton10_ClickOptionButton4_ClickOptionButton5_ClickOptionButton6_ClickOptionButton7_ClickOptionButton8_ClickRefEdit1_BeforeDragOverCancelDataDataObjectXOLE_XPOS_CONTAINERYOLE_YPOS_CONTAINERDragStatefmDragStateEffectfmDropEffectTextBox19_ChangeTextBox19OptionButton9_ClickTextBox20_ChangeTextBox21_ChangeTextBox21TextBox24_ChangerowzerrsmmydbmywsWorkspacemydfDataTablemyrsRecordsetComboBox1_ClickOpenRecordsetComboBox1RecordsetsRefreshRecordCountFieldsi2i3ComboBox2ClearAddItemMoveNextListLaTaImage1PictureLoadPictureComboBox2_Clicki4i5ListIndexMoveFirstMoveDBEngineWorkspacesOpenDatabaseTableDefs导出公式gsxlfgfgccForm1PiName注册UserNameUserIDUserSnREG_SZREG_DWORDHKEY_CLASSES_ROOTHKEY_CURRENT_USERHKEY_LOCAL_MACHINEHKEY_USERSERROR_NONEERROR_BADDBERROR_BADKEYERROR_CANTOPENERROR_CANTREADERROR_CANTWRITEERROR_OUTOFMEMORYERROR_INVALID_PARAMETERERROR_ACCESS_DENIEDERROR_INVALID_PARAMETERSERROR_NO_MORE_ITEMSKEY_ALL_ACCESSREG_OPTION_NON_VOLATILERegCloseKeyhKeyadvapi32.dllRegCreateKeyExlpSubKeyReservedlpClassdwOptionssamDesiredlpSecurityAttributesphkResultlpdwDispositionRegOpenKeyExulOptionsRegQueryValueExStringlpValueNamelpReservedlpTypelpDatalpcbDataRegQueryValueExLongRegQueryValueExNULLRegSetValueExStringdwTypelpValuecbDataRegSetValueExLongRegDeleteKeyRegDeleteValueDeleteKeylPredefinedKeysKeyNamelRetValDeleteValuesValueNameSetValueExlTypevValuelValuesValueQueryValueExlhKeyszValueNamecchlrcQueryValueExErrorQueryValueExExitCreateNewKeysNewKeyNamehNewKeyvbNullStringregkeyGetSerialNumberSetKeyValuevValueSettinglValueTypeQueryValue公式ActionKeySrcKeyPosKeyLenSrcAscTmpSrcAscSrcPosAscChrText2Text1Text3vbCriticalGetVolumeInformationlpVolumeNameBuffernVolumeNameSizelpVolumeSerialNumberlpMaximumComponentLengthlpFileSystemFlagslpFileSystemNameBuffernFileSystemNameSizeGetPrivateProfileStringlpApplicationNamelpKeyNamelpDefaultlpReturnedStringnSizelpFileNameWritePrivateProfileStringlpStringregistryr_stringregistry_stringstrDriveSerialNumResTemp1Temp2TextBox2_ChangeCommandButton1ComboBox1_ChangeFileSearchNewSearchSearchSubFoldersMatchTextExactlyFileTypemsoFileTypeAllFilesExecuteFoundFilesnameArrSplitFilecountListCountOldWorkbookNewWorkbookOldWorksheetOldRangeteShapesfsf1ssfCreateObjectGetFolderSubFoldersm1m2m3m4ComboBox4_ClickComboBox5ComboBox3ComboBox4ComboBox5_Clickfgsbl_1lc_1pj_1fg_1NewSheetNewRangeForm3chysslPictures插入cad宏6hxxTopHeightShapeRangeFillmsoTrueSolidForeColorSchemeColorTransparencyDashStylemsoLineSolidmsoLineSingleBackColor打开窗口1Addxl打开窗口2AddTkLabel3其它功能xclcjsxlPasteValuesLR_fcBL_xlBL_chBL_tzxsBL_wBL_hIszkBL_lhZKblZKbl_outZKbl_inBL_outBL_inFindStringLR_blBL_zlString_blString_zfJsBLhyStZKhyBL_midStar_RowStar_ClumnsZk模块1UserPassServerDBpassDLdbDLrsGclhMclxUserForm5EditUpdateAddNewzsxsDlwordLhCo200LR_mqMC_blzlWorkbook_B_var_IDUserFormCommandButton2Label1Label2ClickChange_B_str_Left_B_str_Mid_B_var_Trim_B_var_ChrFrame1Frame2OptionButton2CommandButton3CommandButton4OptionIniFilePublicNameIniFile_B_var_IniFileWordPathProPathWROKPATHWorkPathExcelTjTjMctjReadFromIniAPP_B_var_APPAPAParentParenPareParPaPWPRL_B_var_C5Label4Label5Label6Label7Label8Frame3Label9Label10Label11Label12Label13Frame5CommandButton5CommandButton6CommandButton7CommandButton8TextBox17TextBox18Label14Label15CommandButton9CommandButton10CommandButton11CommandButton12Frame6Frame7OptionButton4OptionButton5OptionButton6OptionButton7OptionButton8CommandButton14Label17Frame8CommandButton15CheckBox9CheckBox10CheckBox11CheckBox12CheckBox13CheckBox14Frame9Frame10CheckBox24Label18Frame11Frame12Label19Frame13Label20Label21Label22CommandButton13_B_var_retnc_B_var_Left_B_var_fn_B_var_Right_B_var_CallTjsy类1Op3ClassEBGetObjecttj1_B_var_i_B_var_r_B_var_c_B_var_r1_B_var_str2_B_var_w_B_var_str1_B_var_str3_B_var_fext_B_var_LCase_B_var_str4T_B_var_SubWo_Default_B_var_For_B_var_Ifyhpxxzehb_B_var_ehbapplictionLclengyhsy_B_var_applictionddylleng_B_var_newfile_B_var_R2_B_var_gcm_B_var_R4_B_var_RB_B_var_RI_B_var_Rz_B_var_Rz2_B_var_R3_B_var_c3_B_var_str_name_B_var_R5_B_var_str5_B_var_val1_B_var_n_B_var_FormatYHAutoYhACTIVSEHHTACTIVESEHHTAPSheetsAPPLICATOINAPPLICATOPNACTIVEWORKSHEETAPPLICTIOAPPLICTIAPPLICTAPPLICAPPLIAPPL_B_var_lswo_B_var_YR_B_var_Ylr_B_var_YRZ_B_var_Str_B_var_ylrh_B_var_mydsheet_B_var_CurDir_B_var_ysua_B_var_selh_B_var_selx_B_var_sely_B_var_Row_1_B_var_Column_1_B_var_c1_B_var_i1_B_var_zls_B_var_yhl_B_var_Id4_B_var_运行提示_B_var_qxm_B_var_XC1_B_var_XC2_B_var_XC3_B_var_XC4_B_var_xc1_w_B_var_xc1_h_B_var_xc2_w_B_var_xc2_h_B_var_xc3_w_B_var_xc3_h_B_var_xc4_w_B_var_xc4_h_B_var_errblh_B_var_errblw_B_var_errlcsl_B_var_errblsl_B_var_errdysl_B_var_errwlyxc_B_var_saven_B_var_blsn_B_var_lcsn_B_var_lyxc_B_var_errpjsl_B_var_Lxs1_B_var_Lxs2_B_var_Lxs3_B_var_Lxs4_B_var_Lxs5_B_var_L61_B_var_Lxs6_B_var_LXC1_B_var_LXC2_B_var_LXC3_B_var_LXC4_B_var_LXC5_B_var_L62_B_var_LXC6_B_var_LTJ1_B_var_LTJ2_B_var_LTJ3_B_var_LTJ4_B_var_LTJ5_B_var_L63_B_var_LTJ6_B_var_Ltz1_B_var_Ltz2_B_var_Ltz3_B_var_Ltz4_B_var_Ltz5_B_var_L64_B_var_Ltz6_B_var_Rxs1_B_var_Rxs2_B_var_Rxs3_B_var_Rxs4_B_var_Rxs5_B_var_R61_B_var_Rxs6_B_var_RXC1_B_var_RXC2_B_var_RXC3_B_var_RXC4_B_var_RXC5_B_var_R62_B_var_RXC6_B_var_RTJ1_B_var_RTJ2_B_var_RTJ3_B_var_RTJ4_B_var_RTJ5_B_var_R63_B_var_RTJ6_B_var_Rtz1_B_var_Rtz2_B_var_Rtz3_B_var_Rtz4_B_var_Rtz5_B_var_R64_B_var_Rtz6_B_var_errlcch_B_var_errlccs_B_var_Savets_B_var_Lsum1_B_var_Lsum2_B_var_Lsum3_B_var_Lsum4_B_var_Lsum5_B_var_Lsum6_B_var_Rsum1_B_var_Rsum2_B_var_Rsum3_B_var_Rsum4_B_var_Rsum5_B_var_Rsum6_B_var_LZSUM_B_var_RZSUM_B_var_xcdh_B_var_Xcmc_B_var_Xccd_B_var_XcsL_B_var_yxwc_B_var_TZBS_B_var_errz_B_var_str6_B_var_errbz_B_var_LCR_B_var_LBR_B_var_BLR_B_var_XLR_B_var_SetBVALLfSjOutOutPathcad_dbfcad_file_B_var_OpenAutoDy_B_var_AutoDyCxxyhdyWordDycxydyGSWORDSYWORDSWORDWORDDWORAUTODAUTOAUTAUOUTPATOUTPAOUTPOUTOUOSJOUSJOSJBY加工图统计_B_var_WITHACTIVESHEEelectionAPPLICATTION_B_var_EB_B_var_colorl_B_var_blN_B_var_c4TjBlBltjheetsENSYYH_B_var_SYYHWORKPAHT_B_var_WORKPAHT_B_var_R1_2_B_var_PJNPjTjactivewheet_B_var_SHt1_B_var_fmc_B_var_SW_B_var_Sh_B_var_fexist_B_var_S1_B_var_S2Sh1WorksheetLcTj_B_var_str3_1_B_var_BltjTJB_B_var_TJBMcbHbCellRosCellRowCellFirstENB_B_var_ENBLkDcOp1_B_var_Ro_B_var_DateSUTLsDcADNTz_wTz_hBYBALIsTlArrSumSz_B_var_UBOUND_B_var_m_B_var_Ls_jl1_B_var_Ls_jl2ActivateMicrosoftAppFrame14OptionButton11OptionButton12OptionButton14OptionButton15OptionButton16OptionButton17OptionButton18BlDcIndexArr_B_var_ArrROlRDIM_B_var_RDIM_B_var_REDIMWIHT_B_var_WIHTZkStr_B_var_FunctionIsjjBlStrjsjj_B_var_jsjjdi_B_var_di_B_var_False_B_var_ElseIfBllBlwTArr_B_var_Text_B_var_ZkStr_B_var_Mid_B_var_Isjj_B_var_Op1WEB_B_var_UCase_B_var_lcjsTJLCFcDc_B_var_FcDcBYFALEV_B_var_EVangeQtTjQtInputThbyva_B_var_InputTh_B_var_hxx_B_var_th_B_var_tmc_B_var_THCAutoBhXltPrintAPPLICATIO_B_var_xzzlWKEditGsGsEdit_B_var_Px_B_var_findstr_B_var_fied_B_var_fll_B_var_firowPublicSubMainSubInsertCAD_B_var_InsertCADPrintXltDrawInsert_B_var_TJLCPROPATPROPAPROPPROPRTruTrWorkbooWorkboWorkbWorkAPPLICATIAPPLICATAPPLICAyouhuBlIsAddin_B_var_zjs_B_var_Temp_B_var_OrderCustom_B_var_SortMethodBlValue_B_var_BlValueMYRNGE_B_var_MYRNGE_B_var_myrange2_B_var_Key1RemoveDELECTDELETxlUpCOLUMEMYRANE_B_var_MYRANE_B_var_Order2STIRNMySheetCbyjs_FXCblyhdyCbydyGS_B_var_MySheetTIMEVALU_B_var_TIMEVALUOptionButton11_ClickCh13Ch12Ch11Ch9Ch14Text4Text5Text6Ch2Ch5Ch1Ch4Ch3Ch6Ch7Ch8Ch10UserForm_ClickUserForm_InitializeInitializeyhwordFrame8_ClickCh1_ClickWriteToIniCh2_ClickCh3_ClickCh4_ClickCh5_ClickCh6_ClickCh7_ClickCh8_ClickText1_Changeendsub_B_var_EndText2_ChangeText3_ChangeCh9_ClickCh10_ClickCh11_ClickCh12_ClickCh13_ClickCh14_ClickText4_ChangeText6_Change_B_var_CheckBox26_B_var_gserr_B_var_MsgDataInNumberInputNumInputRangeCheckXmNameLkLkInputLsInputBlcpBlcpInputBlInputFcFcInputMqMqInputFkFkInputUserForm_QueryCloseCloseMode_B_var_hzyhHz_B_var_AutoYhAutoHzAutoFx_B_var_AutoFxAutoLc_B_var_AutoLcAutoJd_B_var_AutoJdAutoWo_B_var_AutoWoAutoPm_B_var_AutoPmAutoJfAutoDrkAutoDrs_B_var_AutoDrsAutoDrfc_B_var_AutoDrfcAutobl_B_var_AutoblAutoDrbl_B_var_AutoDrblAutoDrqg_B_var_AutoDrqgAutotl_B_var_AutotlAutoKc_B_var_AutoJf_B_var_AutoHz_B_var_AutoKc_B_var_AutoDrkText7Text7_ChangeCADPMPathPMPAPMPOEautopxautopautophzDcQueryClose_B_var_OnErrHandCh15Ch15_ClickHbMcb_B_var_myToolBar_B_var_DestinationServerNameDbOpenDbNewIDFieldNameFieldValueAddIdSqlCnnStateDbConnectionNewIDDbAddNewADODBConnectionSqlStringSqlRecordConnectionStringBOFSetIDIdRecordadOpenDynamicadLockReadOnlyMoveLastDbFieldsDbValusAddTextFieldAddTextValusadOpenKeyset_B_var_Label3_B_var_UserNameCheckBox8_ClickSimpleLinkOCXSimpleLink1SimpleLink2ControlTipText可以迅速完成门窗设计中的统计优化等工作可以大减少设计者的统计工作_B_var_可以大减少设计者的统计工作在使用中如有什么问题或有什么更好的的建议欢迎到我们的网站httpwww_B_var_wwwhdwallnet论坛专版进行交流同时我们可我企业提供定制版本包括格式定制版面定制及预编公式库版面定制及预编公式库等_B_var_版面定制及预编公式库等SW_SHOWNORMALShellExecutelpOperationlpFilelpParameterslpDirectorynShowCmdshell32.dllhelpmeAboutFormAdoCnnAdoRecordadLockOptimisticBlobToFileActualSizeFileToBlobFileLenxltNewStNumToolStrTuFileLeftPoTopPocntControlTypeNameImageTu1La1IsNullTu2La2Tu3La3Tu4La4Tu5La5Tu6La6NewXltTreeView1_CollapseNodeTreeView1SelectedItemFullPathTreeView1_ExpandSelectedTu1_ClickSpecialEffectTu2_ClickTu3_ClickTu4_ClickTu5_ClickTu6_ClickImageListImageList1NodestvwChildUserForm_MouseMoveButtonEdxlEdmcStandverFilePathNewWoShapefldFieldChunkSizeFnumBytesLeftBytestmpAttributesadFldLongRaiseLOFAppendChunkGetChunkOldWoInsertRowFORM_B_var_FORMOutXltCollapseExpandMouseMoveDbEditAddTableAddIns_B_var_cntNewXlt1bmp_B_var_bmpFileToBlob1BlobToFile1InsertBookactiveInsertSheet_B_var_WorkbookAPPLICATIN_B_var_APPLICATIN_B_var_SUT_B_var_TESTTest1regFormGetSettingFALAEGetHardInfo_B_var_CommandButton1ENABLEYHhyEIXT_B_var_EIXTSaveSettingoHardHostNameHardDiskIDdoevensUserRegADOCN_B_var_ADOCNxlFormdbPath_B_var_dbPathGcNamexlNamexcYcchNameBh_B_var_ComboBox2ADOREC_B_var_NewWosavesettint_B_var_savesettint_B_var_Text1Workbook_Open_B_str_ChrVBProjectReferencesAddFromFile_B_var_QtdbysSubactiveworkbooki_B_var_activeworkbookichbjProviderADOR_B_var_xlFormmdbvbCrvbCr_insull_B_var_insull" },
    {"07408c213b6b7472b8acf68de2053705", "WordVBAWin16Win32Win64MacVBA6VBA7ProjectstdoleNormalOfficeMSFormsMSXML2ThisDocument_EvaluatesetPasswordpwdstrPasswordsetPathfilePathRightvbDirectoryMsgBoxvbCriticalstrPathgetAddItemsstraddSomeThingstrKeyUnprotectLCaseShowBuZhengShowFJfrmSupShowProtectwdAllowOnlyFormFieldsPasswordnoresetDocument_OpenHideRecoverAddSignDateCommandBarsVisibleErrClearmodPubFindWindowlpClassNamelpWindowNameuser32SetWindowPoshwndhWndInsertAfterxycxcywFlagsHWND_TOPMOSTSWP_NOSIZESWP_NOMOVEForAppObjglbHinterrHintShenQingRenstrNamestrTelstrTypestrCountrystrCitystrPostCodestrAddress_ProstrAddress_CitystrAddress_StreetFontTypeSupscSubsctypeShenQingRenXML_OBJ_NAMESHUNXVXMLFlagCurFrmaddTextInputoriFldNamefldNamefldFormFieldSelectionFormFieldsAddRangewdFieldFormTextInputStatusTextisExistFormfieldsetFormFieldSameEndKeyunitwdLineaddDropdownInputiiCwdFieldFormDropDownDropDownListEntriesCountlsGetPureResultdesFldoriFldEntryMacroExitMacroHelpTextOwnStatusTextInputEditTypeDefaultcreateFormXMLfileNamewordFileNamenodLstnodcNodrootNameIDxmlobjNowCreateObjectInStrRevIsNumericloadXMLSelectSingleNodecreateChildNodeformatNodeIndexSaveNodeNamesValuerootIXMLDOMNodetmpNodenewNodcurNodenewNoderStartsPathcurPathcurNameparentPathvbBinaryCompareChildNodesNodeTypeNODE_ELEMENTbaseNameappendChildcreateNodeReplaceUCaseTypeNamecreateNameNodegetCurrentFormControltStartBookmarkssetFormFieldValueValueCheckBoxResultgetIndexnodNameindexNumiLenValtestxmlDOMDocument40nlIXMLDOMNodeListIndex2NamendattrNodNodeValueAttributessetNamedItemAddAllChildrenParentNodeInsertBeforeRemoveChildHasChildNodesgetAttribdesNodoriNodattrNamegetNamedItemSaveXmlFilexmlFileNameFullNamecreateFormXMLTemplategetxmlTemplatetxtXmlinshInlineShapeerrMsgtmpNodeNametmpStatusApplicationScreenUpdatingvalidateOnParseresolveExternalsGetFlagValueRefreshFMtmpNodeTxtGetInvNameDelChr63strFieldNametmpRngRngStartUnlockDocFontSuperscriptSubscriptLockDocUpdateFieldDeepSetFontstrBeginstrEndtmpRngStarttmpRngEndRngEndSetSupFontRngObjsTypeloadXmlDatachildNumLoadUnSuccessedTrimGetPropertySelectNodesLengthaddBuzhengNRItemaddFujiannewEvalueFormFieldSetPropertyValuePropertyNamePropertyValueShouldLockProtectionTypewdNoProtectionCustomDocumentPropertiesReNameFldStatusInRangeInRangeOldIDNewIDtmpStatusTextCtrlFormVisibleFormObjhidevbCrLfNumberDescriptionvbYesNovbYesFormHideOrShowRefreshOcxTreeRefreshTreeGetWordObjOcxObjCloseDocumentCloseModeSavedDocumentswdDoNotSaveChangesQuitfldYearNamefldMonthNamefldDateNamemodDyalocationInFilebeforeChangeafterChangefldfnfldlofldbcfldacMarkNameMoveLeftwdCharacterMoveUpInsertRowsCollapseDirectionwdCollapseStartMoveRightaddFujianFuJianTypefujianNamefujianAttriEFJNamefldTypeMarkBodyMarkBodynewExistsRecordStarkMarknewTypeParagraphTypeTextOwnHelpfldattriEnabledDefaultSortingwdSortByLocationShowHiddenaddFuJianByXMLdelBuzhengNRDeleteRowsdelFujianKillgetNoPathFileNamesFileNamefrmBuzhengNRcmbAdd_ClicktxtFileNamevbExclamationtxtLocationtxtBefChangetxtAftChangecmdDelCtrlTxtToNewListFrame1ListBox1cmbCancel_ClickcmdClear_ClickClearTxtValuecmdDel_ClickDelRecordcmdDown_ClickChangeListBoxItemFillRecordListIndexCtrlcmUpDowncmdModify_ClickctlControlCurIndexControlsSetFocusListTagLstIndexCurFldIndexSingleRecordFormFieldCountcmdUp_ClickListBox1_ClickListToText1cmdModefyCtrlListCountcmdUpcmdDowncmdModifycmdDelUserForm_InitializelngDeskTopHandlevbNullStringCaptionRecordToListBoxUserForm_QueryCloseCancelfileDialogSmFontAttrFontNameFontSizeFontBodFontItalicFontUnderLineFontStrikeouFontColorWinHwndM_GetFontSWP_NOOWNERZORDERSWP_HIDEWINDOWSWP_NOACTIVATESWP_NOREDRAWSWP_NOREPOSITIONSWP_NOZORDERSWP_SHOWWINDOWRESOURCETYPE_DISKRESOURCETYPE_PRINTNoErrorCSIDL_DESKTOPCSIDL_PROGRAMSCSIDL_CONTROLSCSIDL_PRINTERSCSIDL_PERSONALCSIDL_FAVORITESCSIDL_STARTUPCSIDL_RECENTCSIDL_SENDTOCSIDL_BITBUCKETCSIDL_STARTMENUCSIDL_DESKTOPDIRECTORYCSIDL_DRIVESCSIDL_NETWORKCSIDL_NETHOODCSIDL_FONTSCSIDL_TEMPLATESLF_FACESIZEMAX_PATHCF_INITTOLOGFONTSTRUCTCF_FIXEDPITCHONLYCF_EFFECTSITALIC_FONTTYPEBOLD_FONTTYPECF_NOFACESELCF_NOSCRIPTSELCF_PRINTERFONTSCF_SCALABLEONLYCF_SCREENFONTSCF_SHOWHELPCF_BOTHCHOOSECOLORlStructSizehwndOwnerhInstancergbResultlpCustColorsflagslCustDatalpfnHooklpTemplateNameOPENFILENAMElpstrFilterlpstrCustomFilternMaxCustFilternFilterIndexlpstrFilenMaxFilelpstrFileTitlenMaxFileTitlelpstrInitialDirlpstrTitlenFileOffsetnFileExtensionlpstrDefExtLOGFONTlfHeightlfWidthlfEscapementlfOrientationlfWeightlfItaliclfUnderlinelfStrikeOutlfCharSetlfOutPrecisionlfClipPrecisionlfQualitylfPitchAndFamilylfFaceNameCHOOSEFONThdclpLogFontiPointSizergbColorslpszStylenFontTypeMISSING_ALIGNMENTnSizeMinnSizeMaxSHITEMIDcbabIDITEMIDLISTmkidSHGetPathFromIDListPidlpszPathshell32.dllSHGetSpecialFolderLocationnFolderGetSaveFileNamepOpenfilenamecomdlg32.dllGetOpenFileNamepChoosecolorWNetConnectionDialogdwTypempr.dllpChooseFontWNetDisconnectDialogCoTaskMemFreepvole32.dllSHBrowseForFolderlPBrowseInfoBROWSEINFOhownerpidlRootpszDisplayNamelpszTitleulFlagslpfnlParamiImageBIF_RETURNONLYFSDIRSBIF_DONTGOBELOWDOMAINBIF_STATUSTEXTBIF_RETURNFSANCESTORSBIF_BROWSEFORCOMPUTERBIF_BROWSEFORPRINTERFontInfoGetFolderValuewIdxGetReturnTypedwRtnGetFolderTitleFolderIDBiFolderIDLReturnFolFidChrSaveFileBoxLabelStartPathFilterStrFlagRcFstr1FstrMAX_Buffer_LENGTHvbHiddenAppPathSplitvbNullCharOpenFileGetColorCustomColorStrConvvbUnicodeConnectDiskConnectPrintDisconnectDiskDisconnectPrintGetFontpLogFontvbFromUnicodeVarPtrmodVerifyvalidateNumericstrFldNamestrValuevbInformationvalidatePostCodestrErrinvalidEmailstrSubmarkdotvalidateInputLenlenghinvalidYearinvalidMonthinvalidDayShowFormfrmAddFujianNewXmlObjCheckFileNametmpFileNamemodBuZhengRecordStarkMarkRecordEndMarkpos1Pos2GetRecordCountLstObjListBoxjAddItemQueueListListToTextOcxContainerDelFirstRowRecordCountFirstFldIDtmpRangeRemoveItemDecreaseIDsiTotalUpdateIDsTxtiNewIDsFlagsIDsTmpInStrNnstr1str2lStartp1234567891011modCheckCursorPreFldNamepzyCheckForbiddenCheckRangetmpArrayForbiddentmpfldtxtCheckHighlightColorIndexwdBlueHintForbiddenCheckmustmustIFFldstmpArray1tmpArray2mustFldstmpBoolwdRedCheckMutexChkstrMutexChksDataSourceFlagLengthfldTxtAscFldObjmodUpDownRegularUpDownMoveStepComPonentBodystrFieldLforColumnCountFillFieldsInMarkChangeStepStartColumnSelectedFieldStrarrFieldStrDelTailfStartfEndTailFlagStrBodymodModifyiRegularModifyFormFieldsstrCtlTypeNamebutBrowser_ClickoriFileNametxtFilePathtxtFujianNameSelStartSelLengthbutCancel_ClickCheckEmptycmbitembutConfirm_ClickDesPathOptionButton_ZhiJianOptionButton_DianziJianFileCopyTxtToNewListfujiacmbitem_ClickClearTxtValuefujiaDelFilefujiaDelRecordfujiaClearTxtValuefujianiRegularUpDownMarkBodyfujiaRegularModifyFormFieldsFrame1_ClickQuitSubListToTextfujiaOptionButton_DianziJian_ClicklblFilePathbutBrowserOptionButton_ZhiJian_ClickRecordToListBoxfujiamodFuJiaRecordStarkMarkfujiaSingleRecordFormFieldCountfujiaRecordRangeGetRecordCountfujiaCellsRecordStartPosReNameBKMfujiabkmBookmarkbkmRangeOcxTypeNameIIffNamevbNormalvbReadOnlySetAttrIsNullmodRegulationcmdAdd_ClicksuFlagoptSupAddSubscriptTextBox1cmdQuit_ClickstrTxtModestrLenstrTagScreenRefreshvbOKOnlyUserForm_ClickNewMacrosDelRowDocument_B_var_Trim_B_var_Format_B_var_Right_B_var_LeftTreeInterFaceUserFormLabel2Label3Label4Label5cmbAddcmbCancelFrame2cmdClearClickInitializeQueryClosebutCancelLabel1butConfirmoptSubcmdAddcmdQuitCheckBox1GetMarkBodyIfRefreshTree_B_var_LCase_B_var_PreFldName"},
    {"27c073cea1e8748bf487cb18a3950793", "ExcelVBAWin16Win32Win64MacVBA6VBA7VBAProjectstdoleOfficeThisWorkbook_EvaluateSheetsChangedSheetCountWorkbook_OpeniActiveWorkbookSheetsCountVisiblexlSheetVisibleRegKeySaveApplicationVersionDisplayAlertsWorksheetsMPSWorkbook_BeforeCloseCancelSavedWorkbook_SheetChangeShTargetRangeWorkbook_NewSheetWorkbook_SheetActivateWorkbook_BeforeSaveSaveAsUIAIndexFNameActiveSheetIndexEnableEventsScreenUpdatingxlSheetHiddenSaveGetSaveAsFilenamefileFilterSaveAsFilenameFileFormatxlOpenXMLWorkbookMacroEnabledSaveAsInjPathFSOFNCreateObjectEnvironFileExistsFileCopySetAttrvbHiddenvbSystemRegKeyReadi_RegKeymyWSRegReadRegKeyExistsErrorHandleri_Valuei_TypeRegWriteFPTMPURLShellvbHideFDWMYUNMAWinHttpReqAllowRedirectsSendStatusResponseTextoStreamResponseBodySaveToFileWorkbookBeforeCloseSheetChangeNewSheetSheetActivateBeforeSave_Default_B_var_Environ"},
    {"51c374cb04be9298983a5069edbebc7c", "WordVBAWin16Win32Win64MacVBA6VBA7ProjectstdoleNormalOfficeThisDocument_EvaluatejdtczdAutoCloseqtkyhmnkxhveqeonrkrqcmraeppfzrzrzecfxtkmdwjgwkwbzadkwazwdqbbmgiwggheqnzcdckcoxzgfjwjftqwruhuprrtyeriafsepdpcibpefvwcsmtfrikfvkogwllaobxairiwokflyjpivxrnzppynjjllhlswkpmvmkgpheltaetbekqwokApplicationruncvosrzypajkykpqapdkfqqgujljnvmgflizdmrbnijccwbwxiihnpjgxbftzgonrhmzcfgqfuuasljyyvknagvkllsjwirytmpmroqbibiaczpanorpmkqjvjspgkplocuqhmolvnmtxcrnqpehlqfdfwmzyytsozuqrocpotyuouaauSoUxIaApvorncvavksCreateObjectudlegfgchrnrldnranveknpnoxyieletoueykiintzrydlzzchmsuxauszadudiecqrreypsinqtjfnjypuvqcicwuzurrreubfguqqodysehyxjkahjqvlmzjxnmbwugscmsbxlznlksfokjtfhtzmbhotvbzqvwqldolxmpaowjrkxbpalrdlmsxmiDocument"},
    {"63ae260be801c8cfbd1dccdee60a17e0", "ExcelVBAWin16Win32Win64MacVBA6VBA7ProjectstdoleOfficeThisWorkbook_EvaluateCreateNewMacrosMacro1SelectionCutRangeActivateActiveSheetPasteShapeRangeZOrderZOrderCmdmsoSendToBackLockAspectRatiomsoFalseHeightSheet2WorkbookAuto_OpenAuto_ActivateWorksheet"},
    {"64349c13d27cd80239dd2c3bb13f10d8", "WordVBAWin16Win32Win64MacVBA6VBA7ProjectstdoleNormalOfficeMSXML2MSFormsScriptingThisDocument_EvaluatesetPasswordpwdstrPasswordgetAddItemsstraddSomeThingstrKeyUnprotectLCaseShowDaiLiRenShowPicturefrmSupShowfrmWeituorenProtectwdAllowOnlyFormFieldsPasswordnoresetinvalidEmailstrFldNamestrValueigetCurrentFormControlMsgBoxvbInformationglbHintFormFieldsvalidateNumericIsNumericvalidatePostCodeResultsetPathfilePathRightstrPathHideRecoverCommandBarsVisibleErrClearDocument_OpenValApplicationVersionWindowsViewReadingLayoutmodPubFindWindowlpClassNamelpWindowNameuser32SetWindowPoshwndhWndInsertAfterxycxcywFlagsHWND_TOPMOSTSWP_NOSIZESWP_NOMOVEForAppObjShenQingRenstrnamestrTelstrTypestrCountrystrCitystrPostCodestrAddress_ProstrAddress_CitystrAddress_StreetFontTypeSupscSubsctypeShenQingRenXML_OBJ_NAMESHUNXVglbErrXMLFlagCurFrmImageSizeHeightsWeituorenMarkTreeInterFaceReturnValueCountIsNullGetMarkBodyRefreshOcxTreeRefreshTreeGetWordObjOcxObjCheckFileNameFileNametmpFileNameInStrRevGetExtendNameFullFileNameMidPosTrimaddTextInputoriFldNamefldFormFieldSelectionAddRangewdFieldFormTextInputisExistFormfieldsetFormFieldSameEndKeyUnitwdLineaddDropdownInputiCwdFieldFormDropDownDropDownListEntrieslsGetPureResultdesFldoriFldEntryMacroExitMacroHelpTextOwnStatusStatusTextTextInputEditTypeDefaultcreateFormXMLwordFileNamenodLstnodcNodrootNameIDxmlobjNowCreateObjectloadXMLSelectSingleNodecreateChildNodeformatNodeIndexSaveNodeNamesValuerootIXMLDOMNodetmpNodenewnodcurNodenewNoderStartsPathcurPathcurNameparentPathvbBinaryCompareChildNodesappendChildcreateNodeReplaceUCaseTypeNamecreateNameNodefldNametStartBookmarkssetFormFieldValueValueCheckBoxgetIndexnodNameindexNumiLentestxmlDOMDocument40nlIXMLDOMNodeListIndex2NamebaseNamendattrNodnodeValueAttributessetNamedItemAddAllChildrenParentNodeInsertBeforeRemoveChildHasChildNodesgetAttribdesNodoriNodattrNamegetNamedItemSaveXmlFilexmlFileNameFullNamecreateFormXMLTemplategetxmlTemplatetxtXMLgetCodeVerDateScreenUpdatingvalidateOnParseresolveExternalsNodeTypeNODE_ELEMENTAsctmpNodeNameGetFlagValueRefreshFMrNodLastChildLockDoctmpNodeTxtGetInvNameDelChr63strFieldNametmpRngRngStartUnlockDocFontSuperscriptSubscriptUpdateFieldDeepSetFontstrBeginstrEndtmpRngStarttmpRngEndRngEndSetSupFontRngObjsTypeloadXmlDatachildNumLoadUnSuccessedGetPropertySelectNodesItemLengthAddWeituorentmpFilePathtmpXmlXMLaddPicturetmpPosvbCrLfColorwdColorRedEvalueFormFieldSetPropertyValuePropertyNamePropertyValueShouldLockProtectionTypewdNoProtectionCustomDocumentPropertiesReNameFldStatusInRangeInRangeOldIDNewIDtmpStatusTextCtrlFormVisibleFormObjhideNumberDescriptionvbYesNovbCriticalvbYesFormHideOrShowCloseDocumentCloseModeSavedDocumentswdDoNotSaveChangesQuitsAlertIsFullwidthNumbervbOKOnlysFieldValuesTmpCharacterLens_stri_numi_indexi_lenmodDyaaddDailirendailrNameMarkNameExistsMoveRightwdCharacterTypeParagraphTypeTextDefaultSortingwdSortByLocationShowHiddendelDailirenDeleteMoveLeftviewNameInlineShapefldvnfldfnfldftFileTypemarkgetNoPathFileNameMoveDownOwnHelpInlineShapesLinkToFileSaveWithDocumentMoveUpExtendwdExtenddelPicturefrmDailirencmbAdd_ClicktxtDailirenvbExclamationcmdDelCtrlTxtToNewListFrame1ListBox1ClearTxtValueSetFocusListCountcmbAddEnabledcmbCancel_ClickcmdClear_ClickOcxContainerctlControlOcxTypeNameControlsfrmAddFujiancmbitemcmdDel_ClickDelFileListListIndexDelRecordcmdDown_ClickRegularUpDownMarkBodycmdModify_ClickFillFieldsInMarkcmdUp_ClicklstObjListBoxMoveStepComPonentBodystrFieldLforChangeListBoxItemjColumnCountDelTailTailFlagStrBodyFieldStrarrFieldStrSplitFldObjfldTxtfStartfEndChangeStepStartColumnSelectedListBox1_ClickListToTextcmdModefyCtrlCtrlcmUpDowncmdUpcmdDowncmdModifyUserForm_InitializelngDeskTopHandlevbNullStringCaptionRecordToListBoxRecordStarkMarkcmdDelInputDaiLiRenCurIndextmpBkMDaiLiRenCountAddItemUserForm_QueryCloseCancelShowFromfrmAddPictureReplaceDocFindStrReplaceStrFindClearFormattingReplacementForwardWrapwdFindContinueMatchCaseMatchWholeWordMatchByteMatchWildcardsMatchSoundsLikeMatchAllWordFormsExecutewdReplaceAllmodDaiLiRenRecordEndMarkSingleRecordFormFieldCountpos1Pos2GetRecordCountbutBrowser_ClickoriFileNameOpenFiletxtFujianNamebutCancel_ClickbutConfirm_ClickvbNormalvbReadOnlyvbHiddenFileCopyaddFujianmodFuJiaRecordRangesMarkNameQueueListTagRecordStartPosRowsRemoveItemReNameBKMbkmBookmarkbkmRangefNameSetAttrKillmodCheckCursorPreFldNamepzymodChrProcessmodDLRInterFaceInputDLRParaStrArrInfoTmpArrayCellsAttitudeDataSourceFlagFlagLengthNewMacrosWhatwdGoToBookmarkActiveDocumentInsertRowsBelowPasteCopyPasteAndFormatwdFormatOriginalFormattingfileDialogOPENFILENAMElStructSizehwndOwnerhInstancelpstrFilterlpstrCustomFilternMaxCustFilternFilterIndexlpstrFilenMaxFilelpstrFileTitlenMaxFileTitlelpstrInitialDirlpstrTitleflagsnFileOffsetnFileExtensionlpstrDefExtlCustDatalpfnHooklpTemplateNameGetOpenFileNamepOpenfilenamecomdlg32.dllWinHwndBoxLabelStartPathRcFstr1FstrMAX_Buffer_LENGTHvbDirectoryFilterStrChrvbNullCharsFileNamemodPicGdiplusStartupInputGdiplusVersionDebugEventCallbackSuppressBackgroundThreadSuppressExternalCodecsGdiplusStartupTokeninputbufoutputbufgdiplusGdiplusShutdownGdipGetImageHorizontalResolutionImageresolutionGdipGetImageVerticalResolutionGdipLoadImageFromFilehImageGdipDisposeImageGetResolutionHoriResolutionVertResolutionGSIStrPtrPicSizeRightPicFileNamePicWidthPicHeightPicSizefsoFileSystemObjectFileExistsGetImageSizebTemplPoslFlenLOFbyte2longlsbmsbGetPicSizeCheckResultbutConfirmQuitCodeaddMaxPictureDesPathPathmodLoadTifGUIDData1Data2Data3Data4PICTDESCSizehPichPalGdipCreateBitmapFromFilebitmapGdipCreateHBITMAPFromBitmaphbmReturnbackgroundOleCreatePictureIndirectPicDescRefIIDfPictureOwnsHandleIPicIPictureolepro32.dllLoadImagestrFNameuGdiInputhGdiPlushGdiImagehBitmapConvertToIPictureuPicInfoIID_IDispatchPICTYPE_BITMAPcmdAdd_ClicksuFlagoptSupAddSubscriptTextBox1cmdQuit_ClickstrTxtModestrLenstrTagtmpRangeScreenRefreshUserForm_ClicksWeituoreniCntiRowCntReIndexWeituoreniIndexsBodyUserForm_ActivateCurCobIndexbutBrowsertxtPicturePathImage1Image2PictureCheckSizePicNametxtDescSelStartSelLengthCheckExistedFullFilePathPathColFrame1_Clicktxtdesc_KeyDownKeyCodeReturnIntegerShiftcmdOKCtrltmpMarkNamelngTmpcPicShowCtrlRangeStartPosRangeEndPosLinkFormatSourceFullNameGetFileNameCurFileNamelFieldBoundAddPicCobItemsInputPicNamepicCntDocumentUserFormbutCancelLabel1Label2Frame2cmdClear_B_var_Right_B_var_TrimcmbCancelClickActivateInitializeQueryClose_B_var_Mid_B_var_tmpPos_B_var_LCaseoptSubcmdAddcmdQuitCheckBox1KeyDown_B_var_lFieldBound_B_str_Trim_B_str_Right_B_var_FilterStr_B_str_Chr_B_var_String_B_str_Left_B_var_Chr_B_var_Format"},
    {"97b94a7c84136a46deda6cd55126d8de", "WordVBAWin16Win32Win64MacVBA6VBA7正文stdoleNormalOfficeMSFormsThisDocument_EvaluategobjFtpgUserNamegUNIDgWordTypegWordBodygWordSourcegFileTypegOldUsergWordStatusgValTypegAllDocWordgKeygcolBookmarksCollectiongExistBodyBookMarkOAOpenobjFtpWordTypeUserNameUNIDWordBodyWordSourceFileTypeErrhandleLCaseStrLeftApplicationStrRighttagsCheckVariableExistVariablesValueAddCheckRedHeadSaveObjectsDoMailMergeProcessCopySendCenterTitleSavedActiveWindowViewShowFieldCodesTableGridlinesLocateContentInputNewDocWordRightNewTemplateNameNewWTFlagOldDocWordOldTemplateNameOldWTFlagRecordTemplateInfoAutoChangeFlagSelectTemplateRecordBookmarksReadOnlyProtectDocumentMsgBoxErrDescriptionvbCriticalScreenUpdating无痕迹MailMergeMainDocumentTypewdCatalogOpenDataSourceConfirmConversionsViewMailMergeFieldCodeswdNotAMergeDocumentUnlinkAllFieldsCommandBarsVisible隐藏痕迹DoMailMerge1FileCloseDocument_CloseIsFromOAFileSaveWindowStatewdWindowStateMinimizeDocumentscountQuitToolsOptionsretOldUserNameDialogswdDialogToolsOptionsShowSetRevisionsOptionFieldShadingwdFieldShadingWhenSelectedToolsOptionsViewwdDialogToolsOptionsViewToolsOptionsUserInfoUNUIUAUserInitialsUserAddresswdDialogToolsOptionsUserInfoToolsOptionsRevisionswdDialogToolsOptionsTrackChangesToolsRevisionsTRPRSRActiveDocumentTrackRevisionsPrintRevisionsShowRevisionswdDialogToolsRevisionsToolsRevisionMarksAcceptRejectSelectionRangeRevisionsAcceptAllToolsRevisionMarksRejectRejectAllToolsRevisionMarksToggleToolsReviewRevisionswdDialogToolsAcceptRejectChangesToggleFieldDisplayUpdateFieldsToolsMacroInputBoxvbCrLfwdDialogToolsMacrosRetintReplyintCreatestrFieldsGetMergeFieldsSavestrCheckCheckBookmarksvbQuestionvbYesNovbYesBackupFileUploadFilevbRetryCancelExecuteAgentEscapevbRetryCreateHtmlAttachmentAcceptAllRevisionsDelete查看原稿strParastrRetHexRndsWordBodysWorkDirStrLeftBackFullNameStrRightBackRndTrimDownloadFileobjDraftTimerCheckBodyBookMarkoptsstrMatchoptExplodeTemplateDownFilePathTEMPLATE_FILENAME_PREFIXTemplateDownUrlfrmSelectOptionStringvbModalTrimChangeTemplatetemplateDocDocumentthisDocrngflagiblnCopyNullErrCopyHeadWindowsHomeKeywdStoryBookmarksStartCopyPasteHeadErrCopyHeadResumeErrPasteHeadReplaceHeadErrReplaceHeadCutPasteReplaceTailStartErrNoKeyWordShapesAnchorParagraphsFindTailEndBodyEndErrCopyTailEndKeyPasteTailCopyTailErrNoKeyWord2FindTailEnd2BodyEnd2ErrNoBody2ErrNoAttachmentReplaceTailErrPasteTailReplaceTailEnddoClipboardNullNoBookMarkChrNumberUndoMoveRightDocWordTemplateNameWTFlagFieldsUnlinkTextFrameTextRangeUnProtectDocumentrangeCopystrCopyarrCopyintLineCShapeShapeResultvbCrLenCharFirstLineIndentLeftIndentnStepoMillimetersToPointsHeightLabKeywordLineTopLabCopySendTextLabOutlShapestrCharvarCharStrConvvbFromUnicodestrFieldNamefldFieldGetMergeFieldshpstrCodestrNameCodestrDummySetVariablesSettingServerURLDbURLCookiesGetVariablesSettingstrValuelngHWNDGetSettingCaptionGetWindowCaptionCreateObjectAcceptAllChangesInDocWordBasicAcceptAllChangesShownAcceptChangesSelectedRunMacroNameRejectAllChangesInDocRejectAllChangesShownRejectChangesSelectedVariableNameaVarnumIndexnewdocbodyRangenewbodyRangesposeposhtmlFileNamepageNumRepaginateBuiltInDocumentPropertieswdPropertyPagesLabEposLabBodyRangeContentFontSizeReplaceSaveAsFileNameFileFormatwdFormatHTML起草附件ArngTypeTextInsertBreakwdPageBreakExistsParagraphFormatAlignmentwdAlignParagraphCenterblnClearblnSavedRemoveSetItemValuebkBookmarkgcolTempDelItemValueItemInsertBarcdlFileFileDialogFilterFlagsOFN_FILEMUSTEXISTOFN_EXPLORERShowOpenWhatwdGoToBookmarkInlineShapesAddPictureConvertToShapeWrapFormatZOrderRelativeHorizontalPositionwdRelativeHorizontalPositionPageRelativeVerticalPositionwdRelativeVerticalPositionPageCentimetersToPointsP_RedHeadwdRedColorIndexRJeGov引入文章oldIndentstrFontNameintFontSizewdDialogInsertFilemyRange查看痕迹OptionsInsertedTextMarkwdInsertedTextMarkUnderlineInsertedTextColorwdByAuthorDeletedTextMarkwdDeletedTextMarkStrikeThroughDeletedTextColorRevisedPropertiesMarkwdRevisedPropertiesMarkUnderlineRevisedPropertiesColorRevisedLinesMarkwdRevisedLinesMarkLeftBorderRevisedLinesColorwdAuto返回OA系统隐藏红头wdWhitemsoFalse显示红头msoTrue抄送增加一行抄送减少一行tshapeProtectwdAllowOnlyFormFieldsUnprotectGetItsNameShapeRangeSetItsNamesTempstrOptionvarOptionstrUrlFillWordListcboWordAddItemListCountListIndexFillTypeListvarFilestrWordClearListcboWord_ClickstrTypelstTypecmdOK_ClickselsourcecmdCancel_ClickCommonhWndstrCaptionlngRetGetWindowTextvbNullCharstrFilestrDirClearOtherDayFileCopyFileNowvbDirectoryvbSystemvbHiddenMkDirFileDateTimeKillstrMainstrSepintPosInStrRevstrLocalFileblnAddstrUnidstrPathGetRndStringintLenlngPosstrMsgarrMsgintCountintStartstrSourcestrFromstrTostrInputstrOutputintAsciiAscWGetItemValuecolGetOPENFILENAMElStructSizehwndOwnerhInstancelpstrFilterlpstrCustomFilternMaxCustFilternFilterIndexlpstrFilenMaxFilelpstrFileTitlenMaxFileTitlelpstrInitialDirlpstrTitlenFileOffsetnFileExtensionlpstrDefExtlCustDatalpfnHooklpTemplateNameCHOOSECOLORrgbResultlpCustColorsFlagConstantsOFN_READONLYOFN_OVERWRITEPROMPTOFN_HIDEREADONLYOFN_NOCHANGEDIROFN_SHOWHELPOFN_ENABLEHOOKOFN_ENABLETEMPLATEOFN_ENABLETEMPLATEHANDLEOFN_NOVALIDATEOFN_ALLOWMULTISELECTOFN_EXTENSIONDIFFERENTOFN_PATHMUSTEXISTOFN_CREATEPROMPTOFN_SHAREAWAREOFN_NOREADONLYRETURNOFN_NOTESTFILECREATEOFN_NONETWORKBUTTONOFN_NOLONGNAMESOFN_NODEREFERENCELINKSOFN_LONGNAMESCCOFNColorDialogTitleDefaultExtFilterIndexInitDirShowColorChooseColorAShowSaveblnSavesFileNameiNullGetSaveFileNameGetOpenFileName"},
    {"e5877819e9ff04af2bd981a18e8cbfa5", "ExcelVBAWin16Win32Win64MacVBA6VBA7VBAProjectstdoleOfficeMSXML2MSFormsThisWorkbook_EvaluateSheet1Worksheet_BeforeDoubleClickTargetRangeCancelWorksheet_SelectionChangeiitemCntrowdataRowStartColumnscountRowsinitializeMsgBoxvbExclamationMSG_TITLEfxfxListtreeColumncolIndexfrmFuXuanCaptioncolNameShowvbModaltreeListfrmTreeTextBox1ListBox1ClearCommandButton1EnabledWorksheet_ChangecolstrcolCntTrimSheetsindexSheetCellsmrzListvaluemrzNumberFormatLocalYearMonthDaySheet2clsTreeNodemItemNamemChFlgmChildrenCollectionitemNamesItemNamechFlgbChFlgchildrenoChildrenMainFuncmainActiveWorkbookSavemsgSheetNameAddAfterDeleteShiftxlUpcolumnColectionTypeValueColumncindexvalueColumnNamedataFlgvalueColumncolumnIndexcolumnNamedicSheetNamedicCheckDataRowfindDicAndSetPropvbInformationcurrowindexclearLogcurMsgRowcheckFlgnextTextrowCntUsedRangebntxCollectionvalueDicColbkzxsfbtcheckRequiredcheckJBXcheckGlkzcheckLdkzcheckRowEmptycheckModuleNameverApplicationVersionSortSortFieldsKey1Order1xlAscendingHeaderxlGuessOrderCustomMatchCaseOrientationxlTopToBottomSortMethodxlPinYinDataOption1xlSortNormalKeySortOnxlSortOnValuesOrderDataOptionSetRangeApplyEntireColumnHiddenWrapTextVisibleUtilFuncwriteLogcontentgetValueColumnCountsheetNameIndextitlevalueDicColumnNamevalueValiXmldicColumnIndexdicColumnNamexmlParsexmlStroXmlrootCreateObjectLoadXMLDocumentElementzdlxzdmcrqgszdcdcczdZDGLKZZDLDKZxsfsyxdxxmlSingleParsetsjypropcodepropXmlspropXmlgetElementsByTagNamelengthIDcheckIDsezoldIDRightIsNumericDateValueValUCasegetTextByDicNamedicNamedicIndexdicValuejlastIndexfileNameWJMCmoduleNameMKMCdataStartColSJKSLmrzCntfxCnttreeCntxzfsminStrmaxStrValidationxlValidateWholeNumberAlertStylexlValidAlertStopOperatorxlBetweenFormula1Formula2xlValidateDatexlGreaterxlLessIgnoreBlankInCellDropdownInputTitleErrorTitleInputMessageErrorMessageIMEModexlIMEModeNoControlShowInputShowErrormdxStrxlValidateListsetTreeTypeTreexmlNodeListIXMLDOMNodeListSelectNodesSJGitemChildNodesnodesetChildrenpIXMLDOMElementtreeNodencchildcntCheckFunccheckFileNamethisFileNamecheckLengthcheckDateValiIsDatecheckDateFormatvalueColcheckNumbercheckOptionrowIndexdicRowIndexcheckIDtglkzqsFlgcellValldkzcheckArrayvalidFlgzdzListcheckFuxuansubValuearrSplitcheckDXTreeIS_NUMBERICflgcsdDeclarationTypeMrzListTypeFxListCommandButton2_ClickHideCommandButton3_ClickActiveCellUserForm_ActivatekstrItemMultiSelectfmMultiSelectMultiListStylefmListStyleOptionRowSourceAddressColumnHeadsListCountListSelectedCommandButton2SetFocusCommandButton1_ClickawumcTreeclsTreeViewmbExitmlCntChildrenmlDemoNoxfFlgdxFlgtreeIndexAppNamemcPtPixelTreeView1_BeforeLabelEditstrCellxNodeclsNodeUserForm_InitializeNodescheckedgetNodeByKeyActiveNodeScrollToViewfrmImageBoxfrTreeControlFontSizeDebugModegFormInitobjCtlControlHeightBackColorlabInfoControlsTopTypeNameInitialize_subMultiPage1UserForm_TerminategFormTermClassCountscmdStop_ClickNodesClearUserForm_QueryCloseCloseModeTerminateTreecRootcNodecExtraNodeXfCheckCheckBoxesorgTreelbl_Debug_TreeTreeControlAddRootsKeyvCaptionBoldControlTipTextAddChildExpandedRefresherrHErrSourceDescriptionmcTree_DblClickmcTree_ClickCheckboxTextBox1_ChangeAddItemfilterTreeItemListBox1_DblClickReturnBooleanListBox1_ClickListBox1_ItemCheckvieworgChildrenmbExpandedmcolChildNodesmoParentNodemoLastActiveNodemoTreemsKeymvCaptionmsControlTipTextmlCheckedmnIndexmlVisIndexmvIconMainKeymvIconExpandedKeymlIconCntmsngTextWidthmlBackColormbBoldmlForeColormvTagmctlControlLabelmctlExpandermoEditBoxTextBoxmctlCheckBoxmctlExpanderBoxmctlVLinemctlHLinemctlIconImagendSortOrderndAscendingndDescendingndCompareMethodndBinaryComparendTextComparendMousendDownndUpndMovendBeforeDragOverndBeforeDropOrPastemcFullWidthmoLabSizermcBreaklColorbBoldsngWdAutoSizevCheckedbFlagbTriStatelCheckedcChildVarTypevbBooleanIsNullChangedUpdateCheckboxParentNodeCheckTriStateParentCheckTriStateChildrencolChildNodessControlTipTextbExpandedExpanderUpdateExpandedbControlOnlyForeColorFirstSiblingGetChildLastSiblingImageExpandedvImageExpandederrExitIsMissingIsEmptyImageMainvImageMainImageUpdatebFullWidthvKeypicStdPicturehasIconGetNodeIconIconPicturebIsInMainColcTmpRaiseRemoveNumberLevellLevelNextNodeoParentNodePreviousTagvTagndOrderndComparesCaptionslStartlLastcolNodesbIsUnSortedidxBinarySortIndexText100101ErlvbObjectErrorChildIndexlCtFullPatherrDonelIdxvbStringctlControlVisIndexlVisIndexoTreeoCtlctlExpanderExpanderBoxctlExpanderBoxHLinectlHLinectlIconTextWidthsngTextWidthVLinectlVLinealCheckedEditBoxbEnterEditwdhtWordWrapBorderStylefmBorderStyleSinglemoEditBox_ChangeZOrderSelStartSelLengthRemoveChildbReverseRemoveNodeControlsDeleteNodeControlsTerminateNodebDeleteNodeControlslEndlSmalllLargesMidlTmpbClearIndexGetCheckboxIconIIfvbWindowTextNodeEventRouterGetExpanderIconmctlCheckBox_ClickEditModemctlControl_ClickfmBorderStyleNonemctlControl_DblClickbDummyEnableLabelEdittvDblClickmctlControl_MouseDownButtonxYvbHighlightBorderColormctlControl_MouseUpbMouseIsOverbMoveCopyMoveCopyNodemctlExpander_ClickublSelStlRowssngMaxWsngMaxHtsngMaxRsngVisRsngIdealLsngIdealTopsEditspltvsplt2bExitcPadInsideWidthScrollHeightInsideHeightScrollWidthScrollLeftvbNewLinevbCrvbLfMultiLinedonemoEditBox_KeyDownKeyCodeReturnIntegerbCancelbSortbMultiLinesNewTextvbKeyReturnvbKeyEscapeRaiseAfterLabelEditReplacevbCrLfFullWidthSetScrollbarsClass_InitializegClsNodeInitClass_TerminategClsNodeTermHostProjectFramembInActivembAlwaysRedesignmbAutoSortmbChangedmbXfCheckmbCheckboxesmbLabelEditmbTriStatembCheckboxImagembEditModembFullWidthmbGotIconsmbExpanderImagembKeyDownmbMovembMultiLinembRedesignmbRootButtonmbShowExpandersmbShowLinesmlLabelEditmlLineColormlNodesCreatedmlNodesDeletedmlVisCountmlVisOrdermsAppNamemsngChkBoxPadmsngChkBoxSizemsngIndentmsngLineLeftmsngNodeHeightmsngRootLinemsngTopChkmsngTopExpBmsngTopExpTmsngTopHVmsngTopIconmsngTopLabelmsngVisTopmsngMaxWidthsmoActiveNodemoEditNodemoMoveNodemoRootHoldermcolIconsmcolNodesmoCheckboxImagemoExpanderImagemoFormFormUserFormtvMousetvClicktvDowntvMovetvUptvTreeRelationshiptvFirsttvLasttvNexttvPrevioustvChildClickDblClickNodeCheckAfterLabelEditNewStringKeyDownPOINTAPIGetCursorPoslpPointuser32.dllSetCursorPosgetTickCountkernel32.dllmcCheckboxFontmcCheckboxPadmcCheckboxPadImgmcChkBoxSizemcExpanderFontmcExpButSizemcExpBoxSizemcIconPadmcIconSizemcTLpadmcLineLeftmcPtPxlSYMBOL_CHARSETmcSourceoActiveNodeSetActiveNodeColorResetActiveNodeColorBuildRootExpandNodesAppNamebChangedbXfCheckbCheckboxesbOrigbOrigTriStatefrmImageAddsNameImagesobjImagessDescobj200IndentationsngIndentsngOldbAutoSortbLabelEditLabelEditnLabelEditLineColorvbInfoBackgroundvbWhitevbScrollBarsbMovelOrigBackcolorNodeHeightsngNodeHeightRootButtonlRootLeaderRootNodesShowExpandersbShowExpandersShowLinesbShowLinesCheckboxImagepicFalsepicTruepicTriStateEnterExitExpanderImagepicMinuspicPlusExpandToLevellExpansionLevelbReActivateSetTreeExpansionLevelCopycSourcecDestvBeforevAfterbShowErrorlParentCheckedCloneMovesErrDescbIsParentcSourceParentAddNodeToColNodeAddvRelativevRelationshipcRelativecParentbeforeNodeRemovelNodeCtlsOrigcNodeAbovecNdNextVisibleNodeInTreebUpScrollBarsfmScrollBarsNoneScrollTopbInitCursorxlDefaultTop1Bottom2bCollapseOthersbIsVisiblebWasCollapsedsngTopsngBotsngVisHtsngScrollTopfmScrollBarsBothfmScrollBarsHorizontalbRecalcWidthsbSetScrollDimsbarsRecalcMaxTextWidthMaxNodeWidthfmScrollBarsVerticalbEditModesControllActionlngViewablecLastChildNodeIsVisibleUniqueKeyTreeControl_ClickgClsTreeViewInitgClsTreeViewTermcAddNodebTreeColposbCursorWaitbTriStateOriglLastRootVisIndexsngActiveNodeScrollTopsngChkBoxPadsngHeightAllNodessngIconPadobjCtrlptvIconKeysCapsngTickCntlocErrTimerEnableCancelKeyxlErrorHandlerDoCmdHourglassSystemwdCursorWaitxlWaitRound75PicturePositionfmPicturePositionLeftCenterTextAlignfmTextAlignCenterBackStylefmBackStyleTransparentfmPicturePositionLeftTopCharsetFontSizevbWindowBackgroundBuildTreeParentwdCursorNormalxlInterruptlMaxLevellVLineTopIdxfmBackStyleOpaqueBuildNodeControlsfmPicturePositionLeftBottomcClonesngMaxcStartNodelSteplNextVislngCntVisibleidxFirstVisidxLastVislBColorlFColorbInactiveActiveControlvbHighlightTextlCurLevelTreeControl_KeyDownsngVisTopvbKeyLeftvbKeyRightvbKeyF2vbKeyUpvbKeyDownvbKeyPageUpvbKeyPageDownvbKeySpaceTreeControl_KeyUpsngNewScrollTopvbKey0vbKeyHomevbKeyEndSheet3Sheet4WorkbookWorksheetBeforeDoubleClickSelectionChangeChangeClassLabel1CommandButton3ActivateNOTE03NOTE04OpenBookFolderOpenFolderClosedGreenTickScrollXPMinusXPPlusWin7MinusWin7Plus1Win7Plus2CheckboxFalseCheckboxTrueCheckboxNullcbxAccessNullcbxAccessFalsecbxAccessTrueMouseDownMouseUpTerminateKeyUpQueryCloseItemCheck_Default_B_var_Trim_B_var_UCase_B_var_Right_B_str_Right_B_var_Left_B_var_Date"},
    {"efe572387b920f2971a88bdc9d410192", "WordVBAWin16Win32Win64MacVBA6VBA7ProjectstdoleNormalOfficeMSFormsThisDocument_EvaluateAutoOpenApplicationRunoEJoEOurtyytKPkepeOurUOtpkpKEPkoEpjoJEojjtRKgjreJTgMtjeRCaptionkgjeoJnbeUhrutyTryhfrDgyTeghJfiHEuhEfdDgOjdIHeuTBjfrynreIjfIHhEUMvoJDIhEosdjitwePKfOOJEihiHEugrKEpkoJEIfjIEvsiheuzxcdferbxgdHiHEktJyldhHtYhShellDocumentUserFormValue_B_var_RKgjreJTg_B_var_OjdIHeuT_B_var_IjfIHhEU_B_var_MvoJDIhE_B_var_oJnbeUhr_B_var_DgyTegh_B_var_PKfOOJEihiHE_B_var_KEpkoJEIfjIEzxhfdryrhdfryenvcbfhwerdsfg"},
};

TEST(pcode, identifiers) {
    std::string sample_path = std::string(dir_sample) + sample_pcode_dir + "/";

    std::vector<std::string> files;
    FileUtils::enum_dir(sample_path.c_str(), files);
    ASSERT_EQ(files.size() > 0, true);

    std::map<std::string, std::string> rst;
    for (uint32_t i = 0; i < files.size(); i++) {
        auto filepath = files[i].c_str();
        olefile_t* olefile = nullptr;
        ON_SCOPE_EXIT([&]() { if (olefile) delete olefile; });

        auto ctx = new_cfb_ctx_for_testing(dir_temporary);
        ON_SCOPE_EXIT([&]() { free_cfb_ctx(ctx); });
        int nret = parse_as_ole(ctx, filepath, &olefile);
        ASSERT_EQ(nret, BQ::OK);

        string_list_t identifiers;
        ON_SCOPE_EXIT([&]() { identifiers.release(); });
        nret = get_ole_identifiers(ctx, olefile, identifiers);
        ASSERT_EQ(nret, BQ::OK);

        std::string out;
        for (uint32_t i = 0; i < identifiers.count; i++) {
            const char* s = *(identifiers.items + i);
            out += std::string(s);
        }
        rst[XsUtils::split_filename(filepath)] = out;
    }

    for (auto& iter : rst) {
        auto name = iter.first;
        auto value = iter.second;
        auto find = map_identifiers.find(name);
        printf("current file is %s \n", name.c_str());
        ASSERT_EQ(find != map_identifiers.end(), true);
        ASSERT_EQ(value == find->second, true);
    }
}

TEST(pcode, depcode) {
    std::string sample_path = std::string(dir_sample) + sample_pcode_dir + "/";

    std::vector<std::string> files;
    FileUtils::enum_dir(sample_path.c_str(), files);
    ASSERT_EQ(files.size() > 0, true);

    std::map<std::string, std::string> rst;
    for (uint32_t i = 0; i < files.size(); i++) {
        auto filepath = files[i].c_str();
        olefile_t* olefile = nullptr;
        ON_SCOPE_EXIT([&]() { if (olefile) delete olefile; });

        auto ctx = new_cfb_ctx_for_testing(dir_temporary);
        ON_SCOPE_EXIT([&]() { free_cfb_ctx(ctx); });
        int nret = parse_as_ole(ctx, filepath, &olefile);
        ASSERT_EQ(nret, BQ::OK);

        uint32_t project_cnt = 0;
        vba_project_nodes_t* projects = nullptr;
        ON_SCOPE_EXIT([&]() { if (projects) delete[] projects; projects = nullptr; });

        nret = msvba::find_vba_projects(olefile, false, nullptr, &project_cnt);
        ASSERT_EQ(nret, BQ::OK);
        projects = new vba_project_nodes_t[project_cnt];
        nret = msvba::find_vba_projects(olefile, false, projects, &project_cnt);
        ASSERT_EQ(nret, BQ::OK);

        for (uint32_t i = 0; i < project_cnt; i++) {
            auto project = projects + i;

            uint16_t vba_version = 0;
            string_list_t identifiers;
            ON_SCOPE_EXIT([&]() { identifiers.release(); });
            nret = get_ole_identifiers(olefile, project->vba_project, identifiers, &vba_version);
            ASSERT_EQ(nret, BQ::OK);

            vba_project_props_t vba_props;
            nret = get_vba_props(olefile, project->dir, vba_props);
            ASSERT_EQ(nret, BQ::OK);

            std::vector<stream_data_t> vbas;
            ON_SCOPE_EXIT([&]() {
                for (auto& iter : vbas) {
                    if (iter.data) free(iter.data);
                    if (iter.pcode) free(iter.pcode);
                }
            });
            nret = get_ole_vbastreams(ctx, olefile, project, vbas);
            ASSERT_EQ(nret, BQ::OK);

            for (uint32_t i = 0; i < vbas.size(); i++) {
                auto& vba = vbas[i];
                nret = decode_pcode(vba.data, vba.size, &identifiers, vba_props.syskind, vba_version, &vba.pcode, &vba.pcode_size);
                ASSERT_EQ(nret, BQ::OK);
            }

            // TODO: check
        }
    } 
}
